{% extends "base.html" %}
{% block title %}Editar Cliente{% endblock %}
{% block content %}
<h2>Editar Cliente</h2>

<form action="{{ url_for('editar_cliente', cliente_id=cliente.id) }}" method="post" class="row g-3">

  <!-- Orden -->
  <div class="col-md-2">
    <label for="orden" class="form-label">Orden</label>
    <input type="number" class="form-control" id="orden" name="orden" value="{{ cliente.orden }}" required>
  </div>

  <!-- Nombre -->
  <div class="col-md-4">
    <label for="nombre" class="form-label">Nombre</label>
    <input type="text" class="form-control" id="nombre" name="nombre" value="{{ cliente.nombre }}" required>
  </div>

  <!-- Dirección -->
  <div class="col-md-6">
    <label for="direccion" class="form-label">Dirección</label>
    <input type="text" class="form-control" id="direccion" name="direccion" value="{{ cliente.direccion }}">
  </div>

  <!-- Unidades iniciales -->
  <div class="col-md-4">
    <label for="unidades_iniciales" class="form-label">Unidades Iniciales</label>
    <input type="number" step="1" class="form-control" id="unidades_iniciales" name="unidades_iniciales"
           value="{{ cliente.unidades_iniciales }}" required>
  </div>

  <!-- Unidades vendidas -->
  <div class="col-md-4">
    <label for="unidades_vendidas" class="form-label">Unidades Vendidas</label>
    <input type="number" step="1" min="0" class="form-control" id="unidades_vendidas" name="unidades_vendidas"
           value="{{ cliente.unidades_vendidas }}" required>
  </div>

  <!-- Valor unitario -->
  <div class="col-md-4">
    <label for="valor_unitario" class="form-label">Valor Unitario</label>
    <input type="number" step="0.01" class="form-control" id="valor_unitario" name="valor_unitario"
           value="{{ cliente.valor_unitario }}" required>
  </div>

  <!-- Valor total de las unidades vendidas -->
  <div class="col-md-4">
    <label for="valor_total" class="form-label">Valor Total Vendido</label>
    <input type="number" step="0.01" class="form-control" id="valor_total" name="valor_total"
           value="{{ cliente.unidades_vendidas * cliente.valor_unitario }}" readonly>
  </div>

  <div class="col-12">
    <button type="submit" class="btn btn-primary">Guardar Cambios</button>
    <a href="{{ url_for('index') }}" class="btn btn-secondary">Volver</a>
  </div>
</form>

<!-- Script para actualizar automáticamente valor total cuando se cambian unidades vendidas -->
<script>
document.addEventListener("DOMContentLoaded", () => {
    const unidadesInput = document.getElementById("unidades_vendidas");
    const valorUnitarioInput = document.getElementById("valor_unitario");
    const valorTotalInput = document.getElementById("valor_total");

    function actualizarValorTotal() {
        const unidades = parseFloat(unidadesInput.value) || 0;
        const valorUnitario = parseFloat(valorUnitarioInput.value) || 0;
        valorTotalInput.value = (unidades * valorUnitario).toFixed(2);
    }

    unidadesInput.addEventListener("input", actualizarValorTotal);
    valorUnitarioInput.addEventListener("input", actualizarValorTotal);
});
</script>

{% endblock %}
