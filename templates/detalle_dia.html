{% extends "base.html" %}
{% block title %}📅 Detalle del Día{% endblock %}

{% block content %}
<div class="container mt-4 mb-5">
  <h2 class="text-center text-primary fw-bold mb-4">
    📅 Detalle de Caja — {{ fecha|hora_chile }}
  </h2>

  <!-- 💰 Totales del día -->
  <div class="card shadow-sm border-0 mb-4">
    <div class="card-body bg-light">
      <h5 class="mb-3 fw-bold text-dark">💰 Resumen General</h5>
      <p><strong>🛒 Total Ventas:</strong> ${{ "%.2f"|format(total_ventas) }}</p>
      <p><strong>💵 Entradas de Efectivo:</strong> ${{ "%.2f"|format(total_entradas) }}</p>
      <p><strong>💸 Salidas de Efectivo:</strong> ${{ "%.2f"|format(total_salidas) }}</p>
      <p><strong>🧾 Gastos:</strong> ${{ "%.2f"|format(total_gastos) }}</p>
      <hr>
      <h5 class="fw-bold text-success text-end">
        💼 Neto del Día: ${{ "%.2f"|format(neto) }}
      </h5>
      <!-- ✅ Mostrar la hora de generación con hora local de Chile -->
      <p class="text-muted text-end mt-2">
        ⏰ Generado a las: <strong>{{ hora_chile() }}</strong>
      </p>
    </div>
  </div>

  <!-- 📦 Ventas por producto -->
  <div class="card shadow-sm border-0">
    <div class="card-body">
      <h5 class="fw-bold text-dark">📦 Ventas por Producto</h5>

      {% if detalle %}
      <div class="table-responsive mt-3">
        <table class="table table-striped table-hover text-center align-middle shadow-sm">
          <thead class="table-dark">
            <tr>
              <th>Producto</th>
              <th>Cantidad Vendida</th>
              <th>Valor Total</th>
            </tr>
          </thead>
          <tbody>
            {% for d in detalle %}
            <tr>
              <td class="fw-semibold">{{ d.producto }}</td>
              <td>{{ d.vendidas }}</td>
              <td class="text-success fw-bold">${{ "%.2f"|format(d.valor) }}</td>
            </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>
      {% else %}
      <div class="alert alert-info mt-3 text-center">
        No hay ventas registradas en esta fecha.
      </div>
      {% endif %}
    </div>
  </div>

  <!-- 🔙 Botón volver -->
  <div class="text-center mt-5">
    <a href="{{ url_for('app_rutas.liquidacion') }}" class="btn btn-secondary px-4 fw-bold shadow-sm">
      🔙 Volver a Liquidación
    </a>
  </div>
</div>
{% endblock %}
