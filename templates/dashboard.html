{% extends "base.html" %}
{% block title %}📊 Panel de Control — Productos{% endblock %}

{% block content %}
<div class="container mt-4 mb-5">
  <h2 class="mb-4 text-center fw-bold text-primary">📊 Panel de Control — Inventario y Ventas</h2>

  <div class="row g-4">
    <!-- Total de Productos -->
    <div class="col-md-4 col-lg-3">
      <div class="card shadow-sm border-0 text-center p-3 bg-info text-white">
        <h6>📦 Total de Productos</h6>
        <h2 class="fw-bold">{{ total_productos }}</h2>
      </div>
    </div>

    <!-- Total de Unidades Vendidas -->
    <div class="col-md-4 col-lg-3">
      <div class="card shadow-sm border-0 text-center p-3 bg-primary text-white">
        <h6>🛒 Total de Unidades Vendidas</h6>
        <h2 class="fw-bold">{{ total_unidades_vendidas }}</h2>
      </div>
    </div>

    <!-- Valor Total Vendido -->
    <div class="col-md-4 col-lg-3">
      <div class="card shadow-sm border-0 text-center p-3 bg-success text-white">
        <h6>💰 Valor Total Vendido</h6>
        <h2 class="fw-bold">${{ "%.2f"|format(valor_total_vendido) }}</h2>
      </div>
    </div>

    <!-- Total de Movimientos de Caja -->
    <div class="col-md-4 col-lg-3">
      <div class="card shadow-sm border-0 text-center p-3 bg-dark text-white">
        <h6>💼 Movimientos de Caja</h6>
        <h2 class="fw-bold">{{ total_movimientos }}</h2>
      </div>
    </div>
  </div>

  <!-- 📈 Sección de resumen -->
  <div class="card mt-5 shadow-lg border-0">
    <div class="card-header bg-dark text-white">
      <h5 class="mb-0">📈 Resumen General del Negocio</h5>
    </div>
    <div class="card-body bg-light">
      <ul class="list-group list-group-flush">
        <li class="list-group-item d-flex justify-content-between">
          <span>Inventario actual valorizado:</span>
          <!-- ✅ ahora usamos la variable pasada desde Flask -->
          <strong>${{ "{:,.2f}".format(inventario_total) }}</strong>
        </li>
        <li class="list-group-item d-flex justify-content-between">
          <span>Última actualización del sistema:</span>
          <!-- ✅ Mostrar hora local de Chile correctamente -->
          <strong>{{ hora_chile() }}</strong>
        </li>
      </ul>
    </div>
  </div>

  <!-- 👨‍💻 Pie -->
  <div class="text-center mt-5">
    <hr>
    <p class="text-muted">
      💻 Desarrollado con ❤️ por <strong>Manuel Herrera</strong><br>
      <small>Sistema de Inventario y Ventas — versión estable</small>
    </p>
  </div>
</div>
{% endblock %}
